!function(e){function t(t){for(var r,s,o=t[0],u=t[1],c=t[2],f=0,d=[];f<o.length;f++)s=o[f],a[s]&&d.push(a[s][0]),a[s]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(l&&l(t);d.length;)d.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,o=1;o<n.length;o++){var u=n[o];0!==a[u]&&(r=!1)}r&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},a={0:0},i=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var o=window.webpackJsonp=window.webpackJsonp||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var l=u;i.push([175,1]),n()}({173:function(e,t,n){var r={"./af":20,"./af.js":20,"./ar":21,"./ar-dz":22,"./ar-dz.js":22,"./ar-kw":23,"./ar-kw.js":23,"./ar-ly":24,"./ar-ly.js":24,"./ar-ma":25,"./ar-ma.js":25,"./ar-sa":26,"./ar-sa.js":26,"./ar-tn":27,"./ar-tn.js":27,"./ar.js":21,"./az":28,"./az.js":28,"./be":29,"./be.js":29,"./bg":30,"./bg.js":30,"./bm":31,"./bm.js":31,"./bn":32,"./bn.js":32,"./bo":33,"./bo.js":33,"./br":34,"./br.js":34,"./bs":35,"./bs.js":35,"./ca":36,"./ca.js":36,"./cs":37,"./cs.js":37,"./cv":38,"./cv.js":38,"./cy":39,"./cy.js":39,"./da":40,"./da.js":40,"./de":41,"./de-at":42,"./de-at.js":42,"./de-ch":43,"./de-ch.js":43,"./de.js":41,"./dv":44,"./dv.js":44,"./el":45,"./el.js":45,"./en-SG":46,"./en-SG.js":46,"./en-au":47,"./en-au.js":47,"./en-ca":48,"./en-ca.js":48,"./en-gb":49,"./en-gb.js":49,"./en-ie":50,"./en-ie.js":50,"./en-il":51,"./en-il.js":51,"./en-nz":52,"./en-nz.js":52,"./eo":53,"./eo.js":53,"./es":54,"./es-do":55,"./es-do.js":55,"./es-us":56,"./es-us.js":56,"./es.js":54,"./et":57,"./et.js":57,"./eu":58,"./eu.js":58,"./fa":59,"./fa.js":59,"./fi":60,"./fi.js":60,"./fo":61,"./fo.js":61,"./fr":62,"./fr-ca":63,"./fr-ca.js":63,"./fr-ch":64,"./fr-ch.js":64,"./fr.js":62,"./fy":65,"./fy.js":65,"./ga":66,"./ga.js":66,"./gd":67,"./gd.js":67,"./gl":68,"./gl.js":68,"./gom-latn":69,"./gom-latn.js":69,"./gu":70,"./gu.js":70,"./he":71,"./he.js":71,"./hi":72,"./hi.js":72,"./hr":73,"./hr.js":73,"./hu":74,"./hu.js":74,"./hy-am":75,"./hy-am.js":75,"./id":76,"./id.js":76,"./is":77,"./is.js":77,"./it":78,"./it-ch":79,"./it-ch.js":79,"./it.js":78,"./ja":80,"./ja.js":80,"./jv":81,"./jv.js":81,"./ka":82,"./ka.js":82,"./kk":83,"./kk.js":83,"./km":84,"./km.js":84,"./kn":85,"./kn.js":85,"./ko":86,"./ko.js":86,"./ku":87,"./ku.js":87,"./ky":88,"./ky.js":88,"./lb":89,"./lb.js":89,"./lo":90,"./lo.js":90,"./lt":91,"./lt.js":91,"./lv":92,"./lv.js":92,"./me":93,"./me.js":93,"./mi":94,"./mi.js":94,"./mk":95,"./mk.js":95,"./ml":96,"./ml.js":96,"./mn":97,"./mn.js":97,"./mr":98,"./mr.js":98,"./ms":99,"./ms-my":100,"./ms-my.js":100,"./ms.js":99,"./mt":101,"./mt.js":101,"./my":102,"./my.js":102,"./nb":103,"./nb.js":103,"./ne":104,"./ne.js":104,"./nl":105,"./nl-be":106,"./nl-be.js":106,"./nl.js":105,"./nn":107,"./nn.js":107,"./pa-in":108,"./pa-in.js":108,"./pl":109,"./pl.js":109,"./pt":110,"./pt-br":111,"./pt-br.js":111,"./pt.js":110,"./ro":112,"./ro.js":112,"./ru":113,"./ru.js":113,"./sd":114,"./sd.js":114,"./se":115,"./se.js":115,"./si":116,"./si.js":116,"./sk":117,"./sk.js":117,"./sl":118,"./sl.js":118,"./sq":119,"./sq.js":119,"./sr":120,"./sr-cyrl":121,"./sr-cyrl.js":121,"./sr.js":120,"./ss":122,"./ss.js":122,"./sv":123,"./sv.js":123,"./sw":124,"./sw.js":124,"./ta":125,"./ta.js":125,"./te":126,"./te.js":126,"./tet":127,"./tet.js":127,"./tg":128,"./tg.js":128,"./th":129,"./th.js":129,"./tl-ph":130,"./tl-ph.js":130,"./tlh":131,"./tlh.js":131,"./tr":132,"./tr.js":132,"./tzl":133,"./tzl.js":133,"./tzm":134,"./tzm-latn":135,"./tzm-latn.js":135,"./tzm.js":134,"./ug-cn":136,"./ug-cn.js":136,"./uk":137,"./uk.js":137,"./ur":138,"./ur.js":138,"./uz":139,"./uz-latn":140,"./uz-latn.js":140,"./uz.js":139,"./vi":141,"./vi.js":141,"./x-pseudo":142,"./x-pseudo.js":142,"./yo":143,"./yo.js":143,"./zh-cn":144,"./zh-cn.js":144,"./zh-hk":145,"./zh-hk.js":145,"./zh-tw":146,"./zh-tw.js":146};function a(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=i,e.exports=a,a.id=173},175:function(e,t,n){"use strict";n.r(t);var r=n(3),a=n.n(r),i=n(17),s=n(18);a.a.CancelToken;var o=function(e){var t=e.cache.get("api"),n=a.a.create({adapter:Object(i.a)(Object(s.a)(a.a.defaults.adapter,{defaultCache:t}))});return n.defaults.baseURL=e.apiURL,n.defaults.headers.common.Accept="application/json",n.interceptors.response.use(function(e){return e},function(e){if(a.a.isCancel(e))return console.log("Request cancelled"),Promise.reject(e);switch(_.get(e,"response.status")||e.status){case 401:break;case 502:case 504:console.log("fluro.api > connection error retrying"),Fluro.api.request(e.config);break;default:console.log("fluro.api > connection error",e)}return Promise.reject(e)}),n},u=n(1),c=n.n(u),l={mapParameters:function(e){return c.a.map(e,function(e,t){return encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&")},matchInArray:function(e,t,n,r){return c.a.filter(e,function(e){var a,i=c.a.get(e,t);switch(r){case">":a=i>n;break;case"<":a=i<n;break;case">=":a=i>=n;break;case"<=":a=i<=n;break;case"in":a=c.a.includes(i,n);break;default:a=void 0===n?i:i==n}return a})},comma:function(e,t){return c.a.chain(e).compact().map(function(e){return t?c.a.get(e,t):e}).value().join(", ")},getStringID:function(e,t){return e?e._id?String(e._id):String(e):e},arrayIDs:function(e,t){return e?c.a.chain(e).compact().map(function(e){return l.getStringID(e,t)}).compact().uniq().value():e},errorMessage:function(e){var t=c.a.chain(["response.data.message","response.data","message"]).map(function(t){return c.a.get(e,t)}).compact().first().value();return Array.isArray(t)&&(t=t[0]),t&&t.length?t:String(e)}},f=l;function d(){var e={},t={removeAllListeners:function(){e={}},dispatch:function(t,n){e[t]&&e[t].forEach(function(e){return e(n)})},addEventListener:function(t,n){e[t]||(e[t]=[]),-1==e[t].indexOf(n)&&e[t].push(n)},removeEventListener:function(t,n){e[t]||(e[t]=[]);var r=e[t].indexOf(n);-1!=r&&e[t].splice(r,1)},bootstrap:function(e){e&&(e.dispatch=t.dispatch,e.addEventListener=t.addEventListener,e.removeEventListener=t.removeEventListener,e.removeAllListeners=t.removeAllListeners)}};return t}var p=function(e){if(!e.api)throw new Error("Can't Instantiate FluroAuth before FluroAPI exists");var t,n={},r={},a=new d;function i(){var e=n.user;r.onChange&&r.onChange(e),a.dispatch("change",e)}function s(e){r.debug&&console.log(e)}return a.bootstrap(r),r.set=function(e){return n.user=e,s("fluro.auth > user set"),i()},r.logout=function(){return delete n.user,e.cache.reset(),s("fluro.auth > user logout"),i()},r.changeAccount=function(t,n){t=e.utils.getStringID(t),n||(n={});var a=!0;n.disableAutoAuthenticate&&(a=!1);var i=e.api.post(`/token/account/${t}`);return i.then(function(t){a&&(e.cache.reset(),r.set(t.data))},function(e){}),i},r.login=function(t,r){r||(r={});var a=!0;return r.disableAutoAuthenticate&&(a=!1),new Promise(function(s,o){if(!t)return o({message:"Missing credentials!"});if(!t.username||!t.username.length)return o({message:"Username was not provided"});if(!t.password||!t.password.length)return o({message:"Password was not provided"});var u=e.apiURL+"/token/login";r.application&&(u=`${e.domain||""}/fluro/application/login`),r.managedAccount&&(u=e.apiURL+"/managed/"+r.managedAccount+"/login"),r.url&&(u=r.url),e.api.post(u,t,{bypassInterceptor:!0}).then(function(e){a&&(n.user=e.data,i()),s(e)},o)})},r.signup=function(t,r){r||(r={});var a=!0;return r.disableAutoAuthenticate&&(a=!1),new Promise(function(s,o){if(!t)return o({message:"No details provided"});if(!t.firstName||!t.firstName.length)return o({message:"First Name was not provided"});if(!t.lastName||!t.lastName.length)return o({message:"Last Name was not provided"});if(!t.username||!t.username.length)return o({message:"Email/Username was not provided"});if(!t.password||!t.password.length)return o({message:"Password was not provided"});if(!t.confirmPassword||!t.confirmPassword.length)return o({message:"Confirm Password was not provided"});if(t.confirmPassword!=t.password)return o({message:"Your passwords do not match"});var u=e.apiURL+"/token/signup";r.application&&(u=`${e.domain||""}/fluro/application/signup`),r.url&&(u=r.url),e.api.post(u,t,{bypassInterceptor:!0}).then(function(e){a&&(n.user=e.data,i()),s(e)},o)})},r.retrieveUserFromResetToken=function(t,n){return n||(n={}),new Promise(function(r,a){var i=`${e.apiURL}/auth/token/${t}`;n.application&&(i=`${e.domain||""}/fluro/application/reset/${t}`),n.url&&(i=n.url),e.api.get(i,{bypassInterceptor:!0}).then(function(e){return r(e.data)},a)})},r.updateUserWithToken=function(t,n,a){a||(a={});var i=!0;return a.disableAutoAuthenticate&&(i=!1),new Promise(function(s,o){var u=`${e.apiURL}/auth/token/${t}`;a.application&&(u=`${e.domain||""}/fluro/application/reset/${t}`),a.url&&(u=a.url),e.api.post(u,n,{bypassInterceptor:!0}).then(function(t){return i&&(e.cache.reset(),r.set(t.data)),s(t.data)},o)})},r.sendResetPasswordRequest=function(t,n){return n||(n={}),new Promise(function(r,a){if(!t)return a({message:"No details provided"});if(!t.username||!t.username.length)return a({message:"Email/Username was not provided"});t.email=t.username;var i=e.apiURL+"/resend";n.application&&(i=`${e.domain||""}/fluro/application/forgot`),n.url&&(i=n.url),e.api.post(i,t,{bypassInterceptor:!0}).then(r,a)})},r.refreshAccessToken=function(r,a){return t||(t=new Promise(function(o,u){s("fluro.auth > refresh token"),e.api.post("token/refresh",{refreshToken:r,managed:a},{bypassInterceptor:!0}).then(function(e){Object.assign(n.user,e.data),s("fluro.auth > token refreshed"),i(),o(e.data.token),t=null},u)}))},r.sync=function(){return e.api.get("/session").then(function(e){e.data?n.user&&Object.assign(n.user,e.data):n.user=null,s("fluro.auth > server session refreshed"),i()})},r.getCurrentToken=function(){return _.get(n,"user.token")||e.applicationToken},r.getCurrentUser=function(){return _.get(n,"user")},e.api.interceptors.request.use(function(t){if(t.bypassInterceptor)return t;var a=t,i=_.get(n,"user.token"),o=_.get(n,"user.refreshToken");if(!i)return e.applicationToken&&e.applicationToken.length?(a.headers.Authorization="Bearer "+e.applicationToken,s("fluro.auth > using app token"),a):(s("fluro.auth > no token"),a);if(a.headers.Authorization="Bearer "+i,s("fluro.auth > using user token"),!o)return s("fluro.auth > no refresh token"),a;var u=new Date;u.setSeconds(u.getSeconds()+10);var c=_.get(n,"user.expires"),l=new Date(c);if(!r.debug&&u<l)return a;var f="managed"==_.get(n,"user.accountType");return s("fluro.auth > token expired"),new Promise(function(e,t){r.refreshAccessToken(o,f).then(function(t){return s("Token refreshed"),a.headers.Authorization="Bearer "+t,e(a)},t)})},function(e){return Promise.reject(e)}),e.api.interceptors.response.use(function(e){return e},function(e){var t=_.get(e,"response.status")||e.status;switch(s("fluro.auth > error"),t){case 401:r.logout()}return Promise.reject(e)}),r},m=function(e){window||(window={screen:{width:1920,height:1080}});var t=window.devicePixelRatio>1,n={};function r(t,n){if(n.extension&&n.extension.length?(n.title&&n.title.length?(t+=`/file/${n.title}.${n.extension}`,delete n.title):n.filename&&n.filename.length?(t+=`/file/${n.filename}.${n.extension}`,delete n.filename):t+=`/file/file.${n.extension}`,delete n.extension):n.filename&&n.filename.length&&(t+=`/file/${n.filename}`,delete n.filename),!n.withoutToken){var r=e.auth.getCurrentToken();!n.access_token&&r&&(n.access_token=r)}return t}return n.getUrl=function(t,n){if((t=e.utils.getStringID(t))&&String(t).length){n||(n={});var a=`${e.apiURL}/get/${t}`;a=r(a,n);var i=e.utils.mapParameters(n);return i.length&&(a+="?"+i),a}},n.avatarUrl=function(t,n,a){if((t=e.utils.getStringID(t))&&String(t).length){a||(a={}),n||(n="contact");var i=`${e.apiURL}/get/avatar/${n}/${t}`;i=r(i,a);var s=e.utils.mapParameters(a);return s.length&&(i+="?"+s),i}},n.coverUrl=n.coverImage=function(t,n,a){if((t=e.utils.getStringID(t))&&String(t).length){a||(a={}),n||(n="event");var i=`${e.apiURL}/get/${n}/${t}`;i=r(i,a);var s=e.utils.mapParameters(a);return s.length&&(i+="?"+s),i}},n.downloadUrl=function(t,n){if((t=e.utils.getStringID(t))&&String(t).length){n||(n={});var a=`${e.apiURL}/download/${t}`;a=r(a,n);var i=e.utils.mapParameters(n);return i.length&&(a+="?"+i),a}},n.posterUrl=function(n,a,i,s){if((n=e.utils.getStringID(n))&&String(n).length){s||(s={});var o,u=window.screen.width||1920;window.screen.width,o=t?1920:1200,u<=768&&(o=t?1536:768),u<=320&&(o=t?640:320),a||i?(a&&(s.w=a,i||(s.h=Math.round(a*(9/16)))),i&&(s.h=i)):(s.w=o,s.h=Math.round(o*(9/16)));var c=`${e.apiURL}/get/${n}/poster`;c=r(c,s);var l=e.utils.mapParameters(s);return l.length&&(c+="?"+l),c}},n.imageUrl=function(n,a,i,s){if((n=e.utils.getStringID(n))&&String(n).length){s||(s={});var o,u=e.apiURL+"/get/"+n;o=t?1920:1200,window.screen.width<=768&&(o=t?1536:768),window.screen.width<=320&&(o=t?640:320),a||i?(a&&(s.w=a),i&&(s.h=i)):s.w=o,s.quality||(s.quality=90),u=r(u,s);var c=e.utils.mapParameters(s);return c.length&&(u+="?"+c),u}},n.filesize=function(e){if(0==e)return"0 Byte";var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,t),2)+""+["Bytes","kb","mb","gb","tb"][t]},n},g=n(11),h={},v={reset(){c.a.each(h,function(e,t){e.reset()})},get:(e,t)=>h[e]?h[e]:(h[e]=new g.a(t),h[e])},b=n(4),w=n.n(b);const j={defaultTimezone:Intl.DateTimeFormat().resolvedOptions().timeZone,localDate:function(e,t){var n;(n=e?new Date(e):new Date).getTimezoneOffset();if(t||(t=j.defaultTimezone),t){var r=60*(w.a.tz(n,t).utcOffset()-w()(n).utcOffset())*1e3;new Date(n);n.setTime(n.getTime()+r)}return n},formatDate:function(e,t,n){var r=j.localDate(e,n);return w()(r).format(t)},timeago:function(e,t){return w()(e).fromNow(t)},dateFromID:function(e,t,n){e=f.getStringID(e);var r=new Date(1e3*parseInt(e.substring(0,8),16));return j.formatDate(r,t,n)},readableEventDate:function(e,t){var n,r;if(e&&e.startDate){n=j.localDate(e.startDate,e.timezone),r=e.endDate?n:j.localDate(e.endDate,e.timezone),n=w()(n),r=w()(r);var a=n.format("h:mma D MMM YYYY")==r.format("h:mma D MMM YYYY"),i=n.format("YYYY")==r.format("YYYY"),s=n.format("MMM YYYY")==r.format("MMM YYYY"),o=n.format("D MMM YYYY")==r.format("D MMM YYYY");switch(t){case"short":return a?n.format("D MMM"):o?n.format("D MMM"):s?n.format("D")+"-"+r.format("D MMM"):i?n.format("D")+"-"+r.format("D MMM"):n.format("D MMM Y")+" - "+r.format("D MMM Y");default:return a?n.format("h:mma dddd D MMM Y"):o?n.format("h:mma")+" - "+r.format("h:mma dddd D MMM Y"):s?n.format("D")+"-"+r.format("D MMM Y"):i?n.format("D MMM")+" - "+r.format("D MMM Y"):n.format("D MMM Y")+" - "+r.format("D MMM Y")}}}};var k=j,y=function(e,t,n){var r={},a=new d;a.bootstrap(r);var i=t;n&&(i="_"+i);var s,o={key:i,name:t,ids:{}},u={};function l(e){Object.assign(o,e.data),p()}function f(e){p()}function p(){s=null,a.dispatch("change",o)}return r.dispatch=function(){r.onChange&&r.onChange(o),a.dispatch("change",o)},r.isStatted=function(e){return c.a.get(o,`ids['${e}']`)},r.isStatting=function(e){return u[e]},r.toggle=function(e){if(!n)throw Error("Can't use the toggle() method on a non-unique stat");return r.isStatted(e)?r.unset(e):r.set(e)},r.setProcessing=function(e,t){u[e]=t,a.dispatch("statting",{id:e,statting:t})},r.add=function(i){if(n)throw Error("Can't use the add() method on a non-unique stat");var s=`/stat/${i}/${t}`,u=e.api.delete(s);return r.setProcessing(i,!0),u.then(function(e){o.ids[i]=e.data.total,r.setProcessing(i,!1),a.dispatch("change",o)},function(){r.setProcessing(i,!1)}),u},r.unset=function(i){if(!n)throw Error("Can't use the unset() method on a non-unique stat");var s=`/stat/${i}/${t}?unique=true`,u=e.api.delete(s);return r.setProcessing(i,!0),u.then(function(e){delete o.ids[i],r.setProcessing(i,!1),a.dispatch("change",o)},function(){r.setProcessing(i,!1)}),u},r.set=function(i){if(!n)throw Error("Can't use the set() method on a non-unique stat");var s=`/stat/${i}/${t}?unique=true`,u=e.api.post(s);return r.setProcessing(i,!0),u.then(function(e){o.ids[i]=!0,r.setProcessing(i,!1),a.dispatch("change",o)},function(e){r.setProcessing(i,!1),"ExistingUniqueStatError"==c.a.get(e,"response.data.name")&&(o.ids[i]=!0),a.dispatch("change",o)}),u},Object.defineProperty(r,"key",{value:i,writable:!1}),Object.defineProperty(r,"name",{value:t,writable:!1}),Object.defineProperty(r,"ids",{value:o.ids,writable:!1}),Object.defineProperty(r,"pending",{value:u,writable:!1}),r.refresh=function(){if(s)return s;var r,a=`/stat/my/${t}`;return n&&(a+="?unique=true"),r=e.auth.getCurrentUser()?e.api.get(a):new Promise(function(e){return e([])}),s=r,r.then(l,f),r},s=r.refresh().then(l,f),r},S=function(e,t,n,r){var a={total:0},i=new d;i.bootstrap(a);var s=t;r&&(s="_"+s);var o,u={key:s,name:t};function l(e){var t=c.a.get(e,"data.total");u.total=a.total=t,p()}function f(e){p()}function p(){a.processing=!1,i.dispatch("change",u),o=null}return Object.defineProperty(a,"key",{value:s,writable:!1}),Object.defineProperty(a,"name",{value:t,writable:!1}),a.refresh=function(){if(o)return o;var i=`/stat/${n}/${t}`;r&&(i+="?unique=true");var s=e.auth.getCurrentUser();return o=s||e.applicationToken?e.api.get(i,{cache:!1}):new Promise(function(e){return e([])}),a.processing=!0,o.then(l,f),o},o=a.refresh().then(l,f),a},D=function(e){if(!e.api)throw new Error("Can't Instantiate FluroStats before FluroAPI exists");var t={userStores:{},globalStores:{},set:function(n,r){var a=e.utils.getStringID(r);t.getUserStore(n,!0).set(a)},unset:function(n,r){var a=e.utils.getStringID(r);t.getUserStore(n,!0).unset(a)},refresh:function(){var e=[];return c.a.each(t.userStores,function(t){e.push(t.refresh())}),c.a.each(t.globalStores,function(t){e.push(t.refresh())}),Promise.all(e)},getGlobalStoresForKey:function(e){return c.a.filter(t.globalStores,function(t){return t.key==e})},getUserStore:function(n,r){if(n){var a=n;if(r&&(a="_"+a),t.userStores[a])return t.userStores[a];var i=new y(e,n,r);return i.addEventListener("change",function(e){var n=t.getGlobalStoresForKey(e.key);setTimeout(function(){c.a.each(n,function(e){e.refresh()})},1e3)}),t.userStores[a]=i,t.userStores[a]}},getStore:function(n,r,a){if(n){var i=n;a&&(i="_"+i);var s=`${i}.${r}`;return t.globalStores[s]?t.globalStores[s]:(t.globalStores[s]=new S(e,n,r,a),t.globalStores[s])}}};return t},P=function(e){var t={icon:function(e,t){var n;switch(t||(t="far"),e){case"policy":n="id-card";break;case"account":n="browser";break;case"application":n="layer-group";break;case"article":n="file-alt";break;case"asset":n="file-archive";break;case"audio":n="file-audio";break;case"checkin":n="sign-in";break;case"code":n="code";break;case"collection":n="box-full";break;case"component":n="tachometer-alt";break;case"contact":n="child";break;case"definition":n="books-medical";break;case"contactdetail":n="file-invoice";break;case"eventtrack":n="random";break;case"event":n="calendar-star";break;case"family":n="home";break;case"team":n="users";break;case"attendance":n="calendar-check";break;case"image":n="image";break;case"integration":n="plug";break;case"interaction":n="compress";break;case"location":n="map-marked-alt";break;case"mailout":n="paper-plane";break;case"plan":n="clipboard-list";break;case"post":n="sticky-note";break;case"process":n="exchange";break;case"product":n="shopping-cart";break;case"purchase":n="file-invoice-dollar";break;case"query":n="terminal";break;case"reaction":n="bolt";break;case"realm":n="bullseye";break;case"role":n="user-lock";break;case"site":n="sitemap";break;case"tag":n="tag";break;case"ticket":n="ticket-alt";break;case"transaction":n="usd-square";break;case"persona":n="user";break;case"video":n="video"}if(n)return[t,n]},get:function(t,n){return n||(n={}),new Promise(function(r,a){e.api.get(`/defined/type/${t}`,n).then(function(e){r(e.data)},a)})},retrieve:function(t,n){return n||(n={}),n.types=t,new Promise(function(t,r){e.api.post("/defined",n).then(function(e){t(e.data)},r)})}};return t};const A=a.a.CancelToken;var M=function(e){if(!e.api)throw new Error("Can't Instantiate FluroContent before FluroAPI exists");var t,n,r={};r.search=function(n,r,i){return r||(r={}),r.limit||(r.limit=10),t&&t.cancel("Operation canceled by the user."),t=A.source(),new Promise(function(s,o){if(!n||!n.length)return s([]);i||(i={}),i.params=r,i.cancelToken=t.token,e.api.get(`/content/search/${n}`,i).then(function(e){s(e.data)}).catch(function(e){a.a.isCancel(e)})})};var i,s=!0;return r.type=function(t,r){if(r||(r={}),!t)throw Error("No definition name was provided");return n&&s||(n=new Promise(function(n,r){e.api.get(`/defined/${t}`).then(function(e){n(e.data),s=!0}).catch(function(e){r(e),s=!1})})),n},r.mention=function(t,n,r){return n||(n={}),n.limit||(n.limit=5),i&&i.cancel("Operation canceled by the user."),i=A.source(),new Promise(function(s,o){if(!t||!t.length)return s([]);r||(r={}),r.params=n,r.cancelToken=i.token,e.api.get(`/mention/${t}`,r).then(function(e){s(e.data)}).catch(function(e){a.a.isCancel(e)})})},r.query=function(t,n){return t=e.utils.getStringID(t),n||(n={}),new Promise(function(r,a){var i={params:{}};if(n.params&&(i.params=n.params),n.variables){var s=c.a.reduce(n.variables,function(e,t,n){return e[`variables[${n}]`]=t,e},{});c.a.assign(i.params,s)}e.api.get(`/content/_query/${t}`,i).then(function(e){r(e.data)},a)})},r.get=function(t,n){return n||(n={}),new Promise(function(r,a){var i={params:{}};n&&(i.params=n),e.api.get(`/content/get/${t}`,i).then(function(e){r(e.data)},a)})},r.external=function(t,n){return n||(n={}),new Promise(function(r,a){var i={params:{}};n&&(i.params=n),e.api.get(`/content/external/${t}`,i).then(function(e){r(e.data)},a)})},r.slug=function(t,n){return n||(n={}),new Promise(function(r,a){var i={params:{}};n&&(i.params=n),e.api.get(`/content/slug/${t}`,i).then(function(e){r(e.data)},a)})},r.retrieve=function(t,n){return n||(n={}),new Promise(function(r,a){var i={params:{}};n&&(i.params=n),e.api.post("/content/_query",t,i).then(function(e){r(e.data)},a)})},r.related=function(t,n){if(!(t=e.utils.getStringID(t)))throw Error(`No id specified ${t}`);return n||(n={}),new Promise(function(r,a){var i={params:{}};n&&(i.params=n),e.api.get(`/content/related/${t}`,i).then(function(e){r(e.data)},a)})},r.form=function(t,n){if(!(t=e.utils.getStringID(t)))throw Error(`No id specified ${t}`);return n||(n={}),new Promise(function(n,r){e.api.get(`/form/${t}`,{}).then(function(e){console.log("RESOLVE!",e.data),n(e.data)},r)})},r.submitInteraction=function(t,n,r){return r||(r={}),new Promise(function(r,a){e.api.post(`/interact/${t}`,n,{}).then(function(e){r(e.data)},a)})},r.submitPost=function(t,n,r,a){if(!(t=e.utils.getStringID(t)))throw Error(`No target specified ${t}`);return a||(a={}),new Promise(function(a,i){e.api.post(`/post/${t}/${n}`,r,{}).then(function(e){a(e.data)},i)})},r.thread=function(t,n,r){if(!(t=e.utils.getStringID(t)))throw Error(`No target specified ${t}`);return r||(r={}),new Promise(function(r,a){e.api.get(`/post/${t}/${n}`,{}).then(function(e){r(e.data)},a)})},r},I=function(e){if(!e.auth)throw new Error("Can't Instantiate FluroAccess before FluroAccess has been initialized");var t={},n={},r=new d;return r.bootstrap(n),n.setDefaultApplication=function(e){t.application=e,r.dispatch("application",e)},n.isFluroAdmin=function(){var t=e.auth.getCurrentUser();if(t&&"administrator"==t.accountType&&!t.pretender)return!0},n.retrieveCurrentSession=function(){var n=e.auth.getCurrentUser(),r=t.application;return n||r||void 0},n.can=function(e,t,r){if(!n.retrieveCurrentSession())return!1;if(n.isFluroAdmin())return!0;var a=`${e} ${t}`,i=[];switch(e){case"view any":var s=n.retrieveActionableRealms("view any "+t),o=n.retrieveActionableRealms("edit any "+t);i=(i=i.concat(s)).concat(o);break;case"view own":var u=n.retrieveActionableRealms("view own "+t),c=n.retrieveActionableRealms("edit own "+t);i=(i=i.concat(u)).concat(c);break;default:i=n.retrieveActionableRealms(a)}if(i.length)return!0;if(r&&r.length){if(!n.retrieveActionableRealms("include defined "+r).length)return!1;switch(e){case"view any":n.retrieveActionableRealms("view any "+r),n.retrieveActionableRealms("edit any "+r),i=(i=i.concat(s)).concat(o);break;case"view own":var l=n.retrieveActionableRealms("view own "+r),f=n.retrieveActionableRealms("edit own "+r);i=(i=i.concat(l)).concat(f);break;default:i=n.retrieveActionableRealms(e+" "+r)}if(i.length)return!0}return!1},n.retrieveActionableRealms=function(e){var t=n.retrieveCurrentSession();if(!t)return[];var r=t.permissionSets;return c.a.chain(r).map(function(t,n){if(c.a.includes(t.permissions,e)){var r=[];return function e(t,n){t.children&&t.children.length&&c.a.each(t.children,function(t){e(t,n)}),n.push(String(t._id))}(t,r),r}}).flatten().compact().value()},n.has=function(e){var t=n.retrieveCurrentSession();if(!t)return!1;if(n.isFluroAdmin())return!0;var r=t.permissionSets,a=c.a.chain(r).reduce(function(e,t,n){return e.push(t.permissions),e},[]).flattenDeep().compact().uniq().value();return c.a.includes(a,e)},n.isAuthor=function(t){var r=n.retrieveCurrentSession();if(!r)return!1;if(!t)return!1;var a=e.utils.getStringID(r),i=a==e.utils.getStringID(t.author);if(i)return!0;var s=e.utils.getStringID(r.persona);if(s==e.utils.getStringID(t.managedAuthor)&&(i=!0),i)return!0;var o=e.utils.arrayIDs(t.owners);if(o&&o.length&&(i=c.a.includes(o,a)),i)return!0;var u=e.utils.arrayIDs(t.managedOwners);u&&u.length&&(i=c.a.includes(u,s));var l=e.utils.getStringID(t);return a==l&&(i=!0),s==l&&(i=!0),i},n.canEditItem=function(t,r){if(!t)return!1;var a=n.retrieveCurrentSession();if(!a)return!1;var i=e.utils.getStringID(t),s=e.utils.getStringID(a.account),o=e.utils.getStringID(t.account);if(o&&o!=s)return!1;if(n.isFluroAdmin())return!0;var u,l=t._type;t.definition&&(l=t.definition,u=t._type);var f,d=n.isAuthor(t),p=n.retrieveActionableRealms("edit any "+l),m=n.retrieveActionableRealms("edit own "+l);if("realm"==l||"realm"==u?(f=e.utils.arrayIDs(t.trail)).push(i):f=e.utils.arrayIDs(t.realms),u&&u.length&&n.retrieveActionableRealms("include defined "+u).length){var g=n.retrieveActionableRealms("edit any "+u);p=p.concat(g);var h=n.retrieveActionableRealms("edit own "+u);m=m.concat(h)}return!!c.a.intersection(p,f).length||!(!d||!c.a.intersection(m,f).length)},n.canViewItem=function(t,r){if(!t)return!1;if(!n.retrieveCurrentSession())return!1;if(n.isFluroAdmin())return!0;var a,i=e.utils.getStringID(t),s=t._type;t.definition&&(s=t.definition,a=t._type);var o=n.isAuthor(t),u=n.retrieveActionableRealms("view any "+s),l=n.retrieveActionableRealms("view own "+s),f=n.retrieveActionableRealms("edit any "+s),d=n.retrieveActionableRealms("edit own "+s),p=[];p=(p=p.concat(u)).concat(f);var m,g=[];if(g=(g=g.concat(l)).concat(d),"realm"==s||"realm"==a?(m=e.utils.arrayIDs(t.trail)).push(i):m=e.utils.arrayIDs(t.realms),a&&a.length&&n.retrieveActionableRealms("include defined "+a).length){var h=n.retrieveActionableRealms("edit any "+a),v=n.retrieveActionableRealms("view any "+a);p=p.concat(h,v);var b=n.retrieveActionableRealms("edit own "+a),w=n.retrieveActionableRealms("view own "+a);g=g.concat(b,w)}return!!c.a.intersection(p,m).length||!(!o||!c.a.intersection(g,m).length)},n.canDeleteItem=function(t,r){if(!t)return!1;var a=n.retrieveCurrentSession();if(!a)return!1;var i=e.utils.getStringID(t),s=e.utils.getStringID(a.account),o=e.utils.getStringID(t.account);if(o&&o!=s)return!1;if(n.isFluroAdmin())return!0;var u,l=t._type;t.definition&&(l=t.definition,u=t._type);var f,d=n.isAuthor(t),p=n.retrieveActionableRealms("delete any "+l),m=n.retrieveActionableRealms("delete own "+l);if("realm"==l||"realm"==u?(f=e.utils.arrayIDs(t.trail)).push(i):f=e.utils.arrayIDs(t.realms),u&&u.length&&n.retrieveActionableRealms("include defined "+u).length){var g=n.retrieveActionableRealms("delete any "+u);p=p.concat(g);var h=n.retrieveActionableRealms("delete own "+u);m=m.concat(h)}return!!c.a.intersection(p,f).length||!(!d||!c.a.intersection(m,f).length)},n.retrieveSelectableRealms=function(t,n,r,a){a||(a={});var i={definition:n,parentType:r};return a.flat&&(i.flat=!0),new Promise(function(t,n){e.api.get("/realm/selectable",{params:i}).then(function(e){return t(e.data)},n)})},n},$=function(e){switch(e||(e={}),e.apiURL&&e.apiURL.length||(e.apiURL="production"),e.apiURL){case"production":e.apiURL="https://api.fluro.io";break;case"staging":e.apiURL="https://api.staging.fluro.io";break;case"local":e.apiURL="http://api.fluro.localhost:3000"}var t={apiURL:e.apiURL,applicationToken:e.applicationToken,domain:e.domain||"",global:{}},n=v;Object.defineProperty(t,"cache",{value:n,writable:!1});var r=f;Object.defineProperty(t,"utils",{value:r,writable:!1}),(new d).bootstrap(t),t.error=function(e){return t.dispatch("error",r.errorMessage(e))};var a=k;Object.defineProperty(t,"date",{value:a,writable:!1});var i=new o(t);Object.defineProperty(t,"api",{value:i,writable:!1});var s=new M(t);Object.defineProperty(t,"content",{value:s,writable:!1});var u=new p(t);Object.defineProperty(t,"auth",{value:u,writable:!1});var c=new I(t);Object.defineProperty(t,"access",{value:c,writable:!1});var l=new m(t);Object.defineProperty(t,"asset",{value:l,writable:!1});new D(t);Object.defineProperty(t,"stats",{value:new D(t),writable:!1});var g=new P(t);return Object.defineProperty(t,"types",{value:g,writable:!1}),t};t.default=$}});