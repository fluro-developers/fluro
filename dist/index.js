!function(e){function t(t){for(var r,i,u=t[0],s=t[1],l=t[2],p=0,f=[];p<u.length;p++)i=u[p],a[i]&&f.push(a[i][0]),a[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);for(c&&c(t);f.length;)f.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,u=1;u<n.length;u++){var s=n[u];0!==a[s]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},a={0:0},o=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var u=window.webpackJsonp=window.webpackJsonp||[],s=u.push.bind(u);u.push=t,u=u.slice();for(var l=0;l<u.length;l++)t(u[l]);var c=s;o.push([40,1]),n()}({40:function(e,t,n){"use strict";n.r(t);var r=n(7),a=n.n(r),o=n(42),i=n(43),u=function(e){var t=a.a.create({adapter:Object(o.a)(Object(i.a)(a.a.defaults.adapter))});return t.defaults.baseURL=e.apiURL,t.defaults.headers.common.Accept="application/json",t},s=function(e){if(!e.api)throw new Error("Can't Instantiate FluroAuth before FluroAPI exists");var t,n={},r={logout:function(){delete n.token,delete n.user,delete n.refreshToken,delete n.expires,r.onChange&&r.onChange(n)},refreshAccessToken:function(a){return t||(t=new Promise(function(o,i){e.api.post("token/refresh",{refreshToken:a},{bypassInterceptor:!0}).then(function(e){n.user=e.data,n.token=e.data.token,n.refreshToken=e.data.refreshToken,n.expires=e.data.expires,r.onChange&&r.onChange(n),o(e.data.token),t=null},i)}))},getCurrentToken:function(){return n.token||e.applicationToken}};e.api.interceptors.request.use(function(t){if(t.bypassInterceptor)return t;var a=t,o=n.token,i=n.refreshToken;return o?(a.headers.Authorization="Bearer "+o,i?new Date<new Date(n.expires)?a:(console.log("Token expired"),new Promise(function(e,t){r.refreshAccessToken(i).then(function(t){return console.log("Token refreshed"),a.headers.Authorization="Bearer "+t,e(a)},t)})):a):e.applicationToken&&e.applicationToken.length?(a.headers.Authorization="Bearer "+e.applicationToken,a):a},function(e){return Promise.reject(e)}),e.api.interceptors.response.use(function(e){return e},function(t){switch(t.response.status){case 401:r.logout();break;case 502:case 504:return console.log("Retry request"),e.api.request(t.config)}return Promise.reject(t)})},l=function(e){window||(window={screen:{width:1920,height:1080}});var t=window.devicePixelRatio>1,n={};function r(t,n){if(n.extension&&n.extension.length?(n.title&&n.title.length?(n.title,n.extension,delete n.title):n.filename&&n.filename.length?(n.filename,n.extension,delete n.filename):n.extension,delete n.extension):n.filename&&n.filename.length&&(n.filename,delete n.filename),!n.withoutToken){var r=e.auth.getCurrentToken();!n.access_token&&r&&(n.access_token=r)}}return n.getUrl=function(t,n){if(t&&String(t).length){n||(n={});var a=`${e.apiURL}/get/${t}`;r(0,n);var o=e.utils.mapParameters(n);return o.length&&(a+="?"+o),a}},n.avatarUrl=function(t,n,a){if(t&&String(t).length){a||(a={}),n||(n="contact");var o=`${e.apiURL}/get/avatar/${n}/${t}`;r(0,a);var i=e.utils.mapParameters(a);return i.length&&(o+="?"+i),o}},n.coverImage=function(t,n,a){if(t&&String(t).length){a||(a={}),n||(n="event");var o=`${e.apiURL}/get/${n}/${t}`;r(0,a);var i=e.utils.mapParameters(a);return i.length&&(o+="?"+i),o}},n.downloadUrl=function(t,n){if(t&&String(t).length){n||(n={});var a=`${e.apiURL}/download/${t}`;r(0,n);var o=e.utils.mapParameters(n);return o.length&&(a+="?"+o),a}},n.posterUrl=function(n,a,o,i){if(n&&String(n).length){i||(i={});var u,s=window.screen.width||1920;window.screen.width,u=t?1920:1200,s<=768&&(u=t?1536:768),s<=320&&(u=t?640:320),a||o?(a&&(i.w=a,o||(i.h=Math.round(a*(9/16)))),o&&(i.h=o)):(i.w=u,i.h=Math.round(u*(9/16)));var l=`${e.apiURL}/get/${n}/poster`;r(0,i);var c=e.utils.mapParameters(i);return c.length&&(l+="?"+c),l}},n.imageUrl=function(n,a,o,i){if(n&&String(n).length){i||(i={});var u,s=e.apiURL+"/get/"+n;u=t?1920:1200,$window.screen.width<=768&&(u=t?1536:768),$window.screen.width<=320&&(u=t?640:320),a||o?(a&&(i.w=a),o&&(i.h=o)):i.w=u,i.quality||(i.quality=90),r(0,i);var l=e.utils.mapParameters(i);return l.length&&(s+="?"+l),s}},n},c=n(8),p=n.n(c),f={mapParameters:function(e){return p.a.map(e,function(e,t){return encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&")},arrayIDs:function(e,t){return e?p.a.chain(e).compact().map(function(e){return f.getStringID(e,t)}).compact().uniq().value():e},getStringID:function(e,t){return e?e._id?String(e._id):String(e):e}},h=f,d=function(e){switch(e||(e={}),e.apiURL&&e.apiURL.length||(e.apiURL="production"),e.apiURL){case"production":e.apiURL="https://api.fluro.io";break;case"staging":e.apiURL="https://api.staging.fluro.io";break;case"local":e.apiURL="http://api.fluro.localhost:3000"}var t={apiURL:e.apiURL};return Object.defineProperty(t,"api",{value:new u(t),writable:!1}),Object.defineProperty(t,"auth",{value:new s(t),writable:!1}),Object.defineProperty(t,"asset",{value:new l(t),writable:!1}),Object.defineProperty(t,"utils",{value:h,writable:!1}),t};t.default=d}});