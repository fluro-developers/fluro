!function(e){function t(t){for(var r,o,s=t[0],u=t[1],c=t[2],f=0,d=[];f<s.length;f++)o=s[f],a[o]&&d.push(a[o][0]),a[o]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(l&&l(t);d.length;)d.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,s=1;s<n.length;s++){var u=n[s];0!==a[u]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={0:0},i=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var s=window.webpackJsonp=window.webpackJsonp||[],u=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var l=u;i.push([175,1]),n()}({173:function(e,t,n){var r={"./af":20,"./af.js":20,"./ar":21,"./ar-dz":22,"./ar-dz.js":22,"./ar-kw":23,"./ar-kw.js":23,"./ar-ly":24,"./ar-ly.js":24,"./ar-ma":25,"./ar-ma.js":25,"./ar-sa":26,"./ar-sa.js":26,"./ar-tn":27,"./ar-tn.js":27,"./ar.js":21,"./az":28,"./az.js":28,"./be":29,"./be.js":29,"./bg":30,"./bg.js":30,"./bm":31,"./bm.js":31,"./bn":32,"./bn.js":32,"./bo":33,"./bo.js":33,"./br":34,"./br.js":34,"./bs":35,"./bs.js":35,"./ca":36,"./ca.js":36,"./cs":37,"./cs.js":37,"./cv":38,"./cv.js":38,"./cy":39,"./cy.js":39,"./da":40,"./da.js":40,"./de":41,"./de-at":42,"./de-at.js":42,"./de-ch":43,"./de-ch.js":43,"./de.js":41,"./dv":44,"./dv.js":44,"./el":45,"./el.js":45,"./en-SG":46,"./en-SG.js":46,"./en-au":47,"./en-au.js":47,"./en-ca":48,"./en-ca.js":48,"./en-gb":49,"./en-gb.js":49,"./en-ie":50,"./en-ie.js":50,"./en-il":51,"./en-il.js":51,"./en-nz":52,"./en-nz.js":52,"./eo":53,"./eo.js":53,"./es":54,"./es-do":55,"./es-do.js":55,"./es-us":56,"./es-us.js":56,"./es.js":54,"./et":57,"./et.js":57,"./eu":58,"./eu.js":58,"./fa":59,"./fa.js":59,"./fi":60,"./fi.js":60,"./fo":61,"./fo.js":61,"./fr":62,"./fr-ca":63,"./fr-ca.js":63,"./fr-ch":64,"./fr-ch.js":64,"./fr.js":62,"./fy":65,"./fy.js":65,"./ga":66,"./ga.js":66,"./gd":67,"./gd.js":67,"./gl":68,"./gl.js":68,"./gom-latn":69,"./gom-latn.js":69,"./gu":70,"./gu.js":70,"./he":71,"./he.js":71,"./hi":72,"./hi.js":72,"./hr":73,"./hr.js":73,"./hu":74,"./hu.js":74,"./hy-am":75,"./hy-am.js":75,"./id":76,"./id.js":76,"./is":77,"./is.js":77,"./it":78,"./it-ch":79,"./it-ch.js":79,"./it.js":78,"./ja":80,"./ja.js":80,"./jv":81,"./jv.js":81,"./ka":82,"./ka.js":82,"./kk":83,"./kk.js":83,"./km":84,"./km.js":84,"./kn":85,"./kn.js":85,"./ko":86,"./ko.js":86,"./ku":87,"./ku.js":87,"./ky":88,"./ky.js":88,"./lb":89,"./lb.js":89,"./lo":90,"./lo.js":90,"./lt":91,"./lt.js":91,"./lv":92,"./lv.js":92,"./me":93,"./me.js":93,"./mi":94,"./mi.js":94,"./mk":95,"./mk.js":95,"./ml":96,"./ml.js":96,"./mn":97,"./mn.js":97,"./mr":98,"./mr.js":98,"./ms":99,"./ms-my":100,"./ms-my.js":100,"./ms.js":99,"./mt":101,"./mt.js":101,"./my":102,"./my.js":102,"./nb":103,"./nb.js":103,"./ne":104,"./ne.js":104,"./nl":105,"./nl-be":106,"./nl-be.js":106,"./nl.js":105,"./nn":107,"./nn.js":107,"./pa-in":108,"./pa-in.js":108,"./pl":109,"./pl.js":109,"./pt":110,"./pt-br":111,"./pt-br.js":111,"./pt.js":110,"./ro":112,"./ro.js":112,"./ru":113,"./ru.js":113,"./sd":114,"./sd.js":114,"./se":115,"./se.js":115,"./si":116,"./si.js":116,"./sk":117,"./sk.js":117,"./sl":118,"./sl.js":118,"./sq":119,"./sq.js":119,"./sr":120,"./sr-cyrl":121,"./sr-cyrl.js":121,"./sr.js":120,"./ss":122,"./ss.js":122,"./sv":123,"./sv.js":123,"./sw":124,"./sw.js":124,"./ta":125,"./ta.js":125,"./te":126,"./te.js":126,"./tet":127,"./tet.js":127,"./tg":128,"./tg.js":128,"./th":129,"./th.js":129,"./tl-ph":130,"./tl-ph.js":130,"./tlh":131,"./tlh.js":131,"./tr":132,"./tr.js":132,"./tzl":133,"./tzl.js":133,"./tzm":134,"./tzm-latn":135,"./tzm-latn.js":135,"./tzm.js":134,"./ug-cn":136,"./ug-cn.js":136,"./uk":137,"./uk.js":137,"./ur":138,"./ur.js":138,"./uz":139,"./uz-latn":140,"./uz-latn.js":140,"./uz.js":139,"./vi":141,"./vi.js":141,"./x-pseudo":142,"./x-pseudo.js":142,"./yo":143,"./yo.js":143,"./zh-cn":144,"./zh-cn.js":144,"./zh-hk":145,"./zh-hk.js":145,"./zh-tw":146,"./zh-tw.js":146};function a(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=i,e.exports=a,a.id=173},175:function(e,t,n){"use strict";n.r(t);var r=n(3),a=n.n(r),i=n(17),o=n(18);a.a.CancelToken;var s=function(e){var t=e.cache.get("api"),n=a.a.create({adapter:Object(i.a)(Object(o.a)(a.a.defaults.adapter,{defaultCache:t}))});return n.defaults.baseURL=e.apiURL,n.defaults.headers.common.Accept="application/json",n.interceptors.response.use(function(e){return e},function(e){if(a.a.isCancel(e))return console.log("Request cancelled"),Promise.reject(e);switch(_.get(e,"response.status")||e.status){case 401:break;case 502:case 504:console.log("fluro.api > connection error retrying"),Fluro.api.request(e.config);break;default:console.log("fluro.api > connection error",e)}return Promise.reject(e)}),n},u=n(1),c=n.n(u),l={mapParameters:function(e){return c.a.map(e,function(e,t){return encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&")},comma:function(e,t){return c.a.chain(e).compact().map(function(e){return t?c.a.get(e,t):e}).value().join(", ")},getStringID:function(e,t){return e?e._id?String(e._id):String(e):e},arrayIDs:function(e,t){return e?c.a.chain(e).compact().map(function(e){return l.getStringID(e,t)}).compact().uniq().value():e},errorMessage:function(e){var t=c.a.chain(["response.data.message","response.data","message"]).map(function(t){return c.a.get(e,t)}).compact().first().value();return t&&t.length?t:String(e)}},f=l;function d(){var e={},t={removeAllListeners:function(){e={}},dispatch:function(t,n){e[t]&&e[t].forEach(function(e){return e(n)})},addEventListener:function(t,n){e[t]||(e[t]=[]),-1==e[t].indexOf(n)&&e[t].push(n)},removeEventListener:function(t,n){e[t]||(e[t]=[]);var r=e[t].indexOf(n);-1!=r&&e[t].splice(r,1)},bootstrap:function(e){e&&(e.addEventListener=t.addEventListener,e.removeEventListener=t.removeEventListener,e.removeAllListeners=t.removeAllListeners)}};return t}var m=function(e){if(!e.api)throw new Error("Can't Instantiate FluroAuth before FluroAPI exists");var t,n={},r={},a=new d;function i(){var e=n.user;r.onChange&&r.onChange(e),a.dispatch("change",e)}function o(e){r.debug&&console.log(e)}return a.bootstrap(r),r.set=function(e){return n.user=e,o("fluro.auth > user set"),i()},r.logout=function(){return delete n.user,e.cache.reset(),o("fluro.auth > user logout"),i()},r.changeAccount=function(t,n){t=e.utils.getStringID(t),n||(n={});var a=!0;n.disableAutoAuthenticate&&(a=!1);var i=e.api.post(`/token/account/${t}`);return i.then(function(t){a&&(e.cache.reset(),r.set(t.data))},function(e){}),i},r.login=function(t,r){r||(r={});var a=!0;return r.disableAutoAuthenticate&&(a=!1),new Promise(function(o,s){if(!t)return s({message:"Missing credentials!"});if(!t.username||!t.username.length)return s({message:"Username was not provided"});if(!t.password||!t.password.length)return s({message:"Password was not provided"});var u=e.apiURL+"/token/login";r.application&&(u=`${e.domain||""}/fluro/application/login`),r.managedAccount&&(u=e.apiURL+"/managed/"+r.managedAccount+"/login"),r.url&&(u=r.url),e.api.post(u,t,{bypassInterceptor:!0}).then(function(e){a&&(n.user=e.data,i()),o(e)},s)})},r.signup=function(t,r){r||(r={});var a=!0;return r.disableAutoAuthenticate&&(a=!1),new Promise(function(o,s){if(!t)return s({message:"No details provided"});if(!t.firstName||!t.firstName.length)return s({message:"First Name was not provided"});if(!t.lastName||!t.lastName.length)return s({message:"Last Name was not provided"});if(!t.username||!t.username.length)return s({message:"Email/Username was not provided"});if(!t.password||!t.password.length)return s({message:"Password was not provided"});if(!t.confirmPassword||!t.confirmPassword.length)return s({message:"Confirm Password was not provided"});if(t.confirmPassword!=t.password)return s({message:"Your passwords do not match"});var u=e.apiURL+"/token/signup";r.application&&(u=`${e.domain||""}/fluro/application/signup`),r.url&&(u=r.url),e.api.post(u,t,{bypassInterceptor:!0}).then(function(e){a&&(n.user=e.data,i()),o(e)},s)})},r.retrieveUserFromResetToken=function(t,n){return n||(n={}),new Promise(function(r,a){var i=`${e.apiURL}/auth/token/${t}`;n.application&&(i=`${e.domain||""}/fluro/application/reset/${t}`),n.url&&(i=n.url),e.api.get(i,{bypassInterceptor:!0}).then(function(e){return r(e.data)},a)})},r.updateUserWithToken=function(t,n,a){a||(a={});var i=!0;return a.disableAutoAuthenticate&&(i=!1),new Promise(function(o,s){var u=`${e.apiURL}/auth/token/${t}`;a.application&&(u=`${e.domain||""}/fluro/application/reset/${t}`),a.url&&(u=a.url),e.api.post(u,n,{bypassInterceptor:!0}).then(function(t){return i&&(e.cache.reset(),r.set(t.data)),o(t.data)},s)})},r.sendResetPasswordRequest=function(t,n){return n||(n={}),new Promise(function(r,a){if(!t)return a({message:"No details provided"});if(!t.username||!t.username.length)return a({message:"Email/Username was not provided"});t.email=t.username;var i=e.apiURL+"/resend";n.application&&(i=`${e.domain||""}/fluro/application/forgot`),n.url&&(i=n.url),e.api.post(i,t,{bypassInterceptor:!0}).then(r,a)})},r.refreshAccessToken=function(r,a){return t||(t=new Promise(function(s,u){o("fluro.auth > refresh token"),e.api.post("token/refresh",{refreshToken:r,managed:a},{bypassInterceptor:!0}).then(function(e){Object.assign(n.user,e.data),o("fluro.auth > token refreshed"),i(),s(e.data.token),t=null},u)}))},r.getCurrentToken=function(){return _.get(n,"user.token")||e.applicationToken},r.getCurrentUser=function(){return _.get(n,"user")},e.api.interceptors.request.use(function(t){if(t.bypassInterceptor)return t;var a=t,i=_.get(n,"user.token"),s=_.get(n,"user.refreshToken");if(!i)return e.applicationToken&&e.applicationToken.length?(a.headers.Authorization="Bearer "+e.applicationToken,o("fluro.auth > using app token"),a):(o("fluro.auth > no token"),a);if(a.headers.Authorization="Bearer "+i,o("fluro.auth > using user token"),!s)return o("fluro.auth > no refresh token"),a;var u=new Date;u.setSeconds(u.getSeconds()+10);var c=_.get(n,"user.expires"),l=new Date(c);if(!r.debug&&u<l)return a;var f="managed"==_.get(n,"user.accountType");return o("fluro.auth > token expired"),new Promise(function(e,t){r.refreshAccessToken(s,f).then(function(t){return o("Token refreshed"),a.headers.Authorization="Bearer "+t,e(a)},t)})},function(e){return Promise.reject(e)}),e.api.interceptors.response.use(function(e){return e},function(e){var t=_.get(e,"response.status")||e.status;switch(o("fluro.auth > error"),t){case 401:r.logout()}return Promise.reject(e)}),r},p=function(e){window||(window={screen:{width:1920,height:1080}});var t=window.devicePixelRatio>1,n={};function r(t,n){if(n.extension&&n.extension.length?(n.title&&n.title.length?(t+=`/file/${n.title}.${n.extension}`,delete n.title):n.filename&&n.filename.length?(t+=`/file/${n.filename}.${n.extension}`,delete n.filename):t+=`/file/file.${n.extension}`,delete n.extension):n.filename&&n.filename.length&&(t+=`/file/${n.filename}`,delete n.filename),!n.withoutToken){var r=e.auth.getCurrentToken();!n.access_token&&r&&(n.access_token=r)}return t}return n.getUrl=function(t,n){if((t=e.utils.getStringID(t))&&String(t).length){n||(n={});var a=`${e.apiURL}/get/${t}`;a=r(a,n);var i=e.utils.mapParameters(n);return i.length&&(a+="?"+i),a}},n.avatarUrl=function(t,n,a){if((t=e.utils.getStringID(t))&&String(t).length){a||(a={}),n||(n="contact");var i=`${e.apiURL}/get/avatar/${n}/${t}`;i=r(i,a);var o=e.utils.mapParameters(a);return o.length&&(i+="?"+o),i}},n.coverUrl=n.coverImage=function(t,n,a){if((t=e.utils.getStringID(t))&&String(t).length){a||(a={}),n||(n="event");var i=`${e.apiURL}/get/${n}/${t}`;i=r(i,a);var o=e.utils.mapParameters(a);return o.length&&(i+="?"+o),i}},n.downloadUrl=function(t,n){if((t=e.utils.getStringID(t))&&String(t).length){n||(n={});var a=`${e.apiURL}/download/${t}`;a=r(a,n);var i=e.utils.mapParameters(n);return i.length&&(a+="?"+i),a}},n.posterUrl=function(n,a,i,o){if((n=e.utils.getStringID(n))&&String(n).length){o||(o={});var s,u=window.screen.width||1920;window.screen.width,s=t?1920:1200,u<=768&&(s=t?1536:768),u<=320&&(s=t?640:320),a||i?(a&&(o.w=a,i||(o.h=Math.round(a*(9/16)))),i&&(o.h=i)):(o.w=s,o.h=Math.round(s*(9/16)));var c=`${e.apiURL}/get/${n}/poster`;c=r(c,o);var l=e.utils.mapParameters(o);return l.length&&(c+="?"+l),c}},n.imageUrl=function(n,a,i,o){if((n=e.utils.getStringID(n))&&String(n).length){o||(o={});var s,u=e.apiURL+"/get/"+n;s=t?1920:1200,window.screen.width<=768&&(s=t?1536:768),window.screen.width<=320&&(s=t?640:320),a||i?(a&&(o.w=a),i&&(o.h=i)):o.w=s,o.quality||(o.quality=90),u=r(u,o);var c=e.utils.mapParameters(o);return c.length&&(u+="?"+c),u}},n.filesize=function(e){if(0==e)return"0 Byte";var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,t),2)+""+["Bytes","kb","mb","gb","tb"][t]},n},h=n(11),g={},v={reset(){c.a.each(g,function(e,t){e.reset()})},get:(e,t)=>g[e]?g[e]:(g[e]=new h.a(t),g[e])},j=n(7),w=n.n(j);const b={defaultTimezone:Intl.DateTimeFormat().resolvedOptions().timeZone,localDate:function(e,t){var n;(n=e?new Date(e):new Date).getTimezoneOffset();if(t||(t=b.defaultTimezone),t){var r=60*(w.a.tz(n,t).utcOffset()-w()(n).utcOffset())*1e3;new Date(n);n.setTime(n.getTime()+r)}return n},formatDate:function(e,t,n){var r=b.localDate(e,n);return w()(r).format(t)},dateFromID:function(e,t,n){e=f.getStringID(e);var r=new Date(1e3*parseInt(e.substring(0,8),16));return b.formatDate(r,t,n)},readableEventDate:function(e,t){var n,r;if(e&&e.startDate){n=b.localDate(e.startDate,e.timezone),r=e.endDate?n:b.localDate(e.endDate,e.timezone),n=w()(n),r=w()(r);var a=n.format("h:mma D MMM YYYY")==r.format("h:mma D MMM YYYY"),i=n.format("YYYY")==r.format("YYYY"),o=n.format("MMM YYYY")==r.format("MMM YYYY"),s=n.format("D MMM YYYY")==r.format("D MMM YYYY");switch(t){case"short":return a?n.format("D MMM"):s?n.format("D MMM"):o?n.format("D")+"-"+r.format("D MMM"):i?n.format("D")+"-"+r.format("D MMM"):n.format("D MMM Y")+" - "+r.format("D MMM Y");default:return a?n.format("h:mma dddd D MMM Y"):s?n.format("h:mma")+" - "+r.format("h:mma dddd D MMM Y"):o?n.format("D")+"-"+r.format("D MMM Y"):i?n.format("D MMM")+" - "+r.format("D MMM Y"):n.format("D MMM Y")+" - "+r.format("D MMM Y")}}}};var y=b,k=function(e,t,n){var r={},a=new d;a.bootstrap(r);var i=t;n&&(i="_"+i);var o,s={key:i,name:t,ids:{}},u={};function l(e){Object.assign(s,e.data),m()}function f(e){console.log(t,"stats could not be retrieved",e),m()}function m(){o=null}r.dispatch=function(){r.onChange&&r.onChange(s),a.dispatch("change",s)},r.isStatted=function(e){return c.a.get(s,`ids['${e}']`)},r.isStatting=function(e){return u[e]},r.toggle=function(e){if(!n)throw Error("Can't use the toggle() method on a non-unique stat");return r.isStatted(e)?r.unset(e):r.set(e)},r.add=function(r){if(n)throw Error("Can't use the add() method on a non-unique stat");var a=`/stat/${r}/${t}`,i=e.api.delete(a);return u[r]=!0,i.then(function(e){s.ids[r]=e.data.total,u[r]=!1},function(){u[r]=!1}),i},r.unset=function(r){if(!n)throw Error("Can't use the unset() method on a non-unique stat");var a=`/stat/${r}/${t}?unique=true`,i=e.api.delete(a);return u[r]=!0,i.then(function(e){delete s.ids[r],u[r]=!1,console.log("unset() complete")},function(){u[r]=!1,console.log("unset() error")}),i},r.set=function(r){if(!n)throw Error("Can't use the set() method on a non-unique stat");var a=`/stat/${r}/${t}?unique=true`,i=e.api.post(a);return u[r]=!0,i.then(function(e){s.ids[r]=!0,u[r]=!1,console.log("set() complete")},function(e){u[r]=!1,"ExistingUniqueStatError"==c.a.get(e,"response.data.name")?(s.ids[r]=!0,console.log("set() complete")):console.log("set() error")}),i},Object.defineProperty(r,"key",{value:i,writable:!1}),Object.defineProperty(r,"name",{value:t,writable:!1}),Object.defineProperty(r,"ids",{value:s.ids,writable:!1}),Object.defineProperty(r,"pending",{value:u,writable:!1}),r.refresh=function(){if(o)return o;var r,a=`/stat/my/${t}`;return n&&(a+="?unique=true"),r=e.auth.getCurrentUser()?e.api.get(a):new Promise(function(e){return e([])}),o=r,r.then(l,f),r};var p=r.refresh();return p.then(l,f),o=p,r},D=function(e){if(!e.api)throw new Error("Can't Instantiate FluroStats before FluroAPI exists");var t={stores:{},refresh:function(){var e=[];return c.a.each(t.stores,function(t){e.push(t.refresh())}),Promise.all(e)},getStore:function(n,r){var a=n;return r&&(a="_"+a),t.stores[a]?t.stores[a]:(t.stores[a]=new k(e,n,r),t.stores[a])}};return t},M=function(e){var t={retrieve:function(t,n){return n||(n={}),n.types=t,e.api.post("/defined",n)}};return t};const A=a.a.CancelToken;var R=function(e){if(!e.api)throw new Error("Can't Instantiate FluroContent before FluroAPI exists");var t,n,r={};return r.search=function(n,r,i){return r||(r={}),r.limit||(r.limit=10),t&&t.cancel("Operation canceled by the user."),t=A.source(),new Promise(function(o,s){if(!n||!n.length)return o([]);i||(i={}),i.params=r,i.cancelToken=t.token,e.api.get(`/content/search/${n}`,i).then(function(e){o(e.data)}).catch(function(e){a.a.isCancel(e)})})},r.mention=function(t,r,i){return r||(r={}),r.limit||(r.limit=5),n&&n.cancel("Operation canceled by the user."),n=A.source(),new Promise(function(o,s){if(!t||!t.length)return o([]);i||(i={}),i.params=r,i.cancelToken=n.token,e.api.get(`/mention/${t}`,i).then(function(e){o(e.data)}).catch(function(e){a.a.isCancel(e)})})},r.query=function(t,n){return t=e.utils.getStringID(t),n||(n={}),new Promise(function(r,a){var i={params:{}};if(n.params&&(i.params=n.params),n.variables){var o=c.a.reduce(n.variables,function(e,t,n){return e[`variables[${n}]`]=t,e},{});c.a.assign(i.params,o)}e.api.get(`/content/_query/${t}`,i).then(function(e){r(e.data)},a)})},r.get=function(t,n){return n||(n={}),new Promise(function(r,a){var i={params:{}};n&&(i.params=n),e.api.get(`/content/get/${t}`,i).then(function(e){r(e.data)},a)})},r.external=function(t,n){return n||(n={}),new Promise(function(r,a){var i={params:{}};n&&(i.params=n),e.api.get(`/content/external/${t}`,i).then(function(e){r(e.data)},a)})},r.slug=function(t,n){return n||(n={}),new Promise(function(r,a){var i={params:{}};n&&(i.params=n),e.api.get(`/content/external/${t}`,i).then(function(e){r(e.data)},a)})},r.retrieve=function(t,n){return n||(n={}),new Promise(function(r,a){var i={params:{}};n&&(i.params=n),e.api.post("/content/_query",t,i).then(function(e){r(e.data)},a)})},r},P=function(e){if(!e.auth)throw new Error("Can't Instantiate FluroAccess before FluroAccess has been initialized");var t={},n={},r=new d;return r.bootstrap(n),n.setDefaultApplication=function(e){t.application=e,r.dispatch("application",e)},n.isFluroAdmin=function(){var t=e.auth.getCurrentUser();if(t&&"administrator"==t.accountType&&!t.pretender)return!0},n.retrieveCurrentSession=function(){var n=e.auth.getCurrentUser(),r=t.application;return n||r||void 0},n.can=function(e,t,r){if(!n.retrieveCurrentSession())return!1;if(n.isFluroAdmin())return!0;var a=`${e} ${t}`,i=[];switch(e){case"view any":var o=n.retrieveActionableRealms("view any "+t),s=n.retrieveActionableRealms("edit any "+t);i=(i=i.concat(o)).concat(s);break;case"view own":var u=n.retrieveActionableRealms("view own "+t),c=n.retrieveActionableRealms("edit own "+t);i=(i=i.concat(u)).concat(c);break;default:i=n.retrieveActionableRealms(a)}if(i.length)return!0;if(r&&r.length){if(!n.retrieveActionableRealms("include defined "+r).length)return!1;switch(e){case"view any":n.retrieveActionableRealms("view any "+r),n.retrieveActionableRealms("edit any "+r),i=(i=i.concat(o)).concat(s);break;case"view own":var l=n.retrieveActionableRealms("view own "+r),f=n.retrieveActionableRealms("edit own "+r);i=(i=i.concat(l)).concat(f);break;default:i=n.retrieveActionableRealms(e+" "+r)}if(i.length)return!0}return!1},n.retrieveActionableRealms=function(e){var t=n.retrieveCurrentSession();if(!t)return[];var r=t.permissionSets;return c.a.chain(r).map(function(t,n){if(c.a.includes(t.permissions,e)){var r=[];return function e(t,n){t.children&&t.children.length&&c.a.each(t.children,function(t){e(t,n)}),n.push(String(t._id))}(t,r),r}}).flatten().compact().value()},n.has=function(e){var t=n.retrieveCurrentSession();if(!t)return!1;if(n.isFluroAdmin())return!0;var r=t.permissionSets,a=c.a.chain(r).reduce(function(e,t,n){return e.push(t.permissions),e},[]).flattenDeep().compact().uniq().value();return c.a.includes(a,e)},n.isAuthor=function(t){var r=n.retrieveCurrentSession();if(!r)return!1;if(!t)return!1;var a=e.utils.getStringID(r),i=a==e.utils.getStringID(t.author);if(i)return!0;var o=e.utils.getStringID(r.persona);if(o==e.utils.getStringID(t.managedAuthor)&&(i=!0),i)return!0;var s=e.utils.arrayIDs(t.owners);if(s&&s.length&&(i=c.a.includes(s,a)),i)return!0;var u=e.utils.arrayIDs(t.managedOwners);u&&u.length&&(i=c.a.includes(u,o));var l=e.utils.getStringID(t);return a==l&&(i=!0),o==l&&(i=!0),i},n.canEditItem=function(t,r){if(!t)return!1;var a=n.retrieveCurrentSession();if(!a)return!1;var i=e.utils.getStringID(t),o=e.utils.getStringID(a.account),s=e.utils.getStringID(t.account);if(s&&s!=o)return!1;if(n.isFluroAdmin())return!0;var u,l=t._type;t.definition&&(l=t.definition,u=t._type);var f,d=n.isAuthor(t),m=n.retrieveActionableRealms("edit any "+l),p=n.retrieveActionableRealms("edit own "+l);if("realm"==l||"realm"==u?(f=e.utils.arrayIDs(t.trail)).push(i):f=e.utils.arrayIDs(t.realms),u&&u.length&&n.retrieveActionableRealms("include defined "+u).length){var h=n.retrieveActionableRealms("edit any "+u);m=m.concat(h);var g=n.retrieveActionableRealms("edit own "+u);p=p.concat(g)}return!!c.a.intersection(m,f).length||!(!d||!c.a.intersection(p,f).length)},n.canViewItem=function(t,r){if(!t)return!1;if(!n.retrieveCurrentSession())return!1;if(n.isFluroAdmin())return!0;var a,i=e.utils.getStringID(t),o=t._type;t.definition&&(o=t.definition,a=t._type);var s=n.isAuthor(t),u=n.retrieveActionableRealms("view any "+o),l=n.retrieveActionableRealms("view own "+o),f=n.retrieveActionableRealms("edit any "+o),d=n.retrieveActionableRealms("edit own "+o),m=[];m=(m=m.concat(u)).concat(f);var p,h=[];if(h=(h=h.concat(l)).concat(d),"realm"==o||"realm"==a?(p=e.utils.arrayIDs(t.trail)).push(i):p=e.utils.arrayIDs(t.realms),a&&a.length&&n.retrieveActionableRealms("include defined "+a).length){var g=n.retrieveActionableRealms("edit any "+a),v=n.retrieveActionableRealms("view any "+a);m=m.concat(g,v);var j=n.retrieveActionableRealms("edit own "+a),w=n.retrieveActionableRealms("view own "+a);h=h.concat(j,w)}return!!c.a.intersection(m,p).length||!(!s||!c.a.intersection(h,p).length)},n.canDeleteItem=function(t,r){if(!t)return!1;var a=n.retrieveCurrentSession();if(!a)return!1;var i=e.utils.getStringID(t),o=e.utils.getStringID(a.account),s=e.utils.getStringID(t.account);if(s&&s!=o)return!1;if(n.isFluroAdmin())return!0;var u,l=t._type;t.definition&&(l=t.definition,u=t._type);var f,d=n.isAuthor(t),m=n.retrieveActionableRealms("delete any "+l),p=n.retrieveActionableRealms("delete own "+l);if("realm"==l||"realm"==u?(f=e.utils.arrayIDs(t.trail)).push(i):f=e.utils.arrayIDs(t.realms),u&&u.length&&n.retrieveActionableRealms("include defined "+u).length){var h=n.retrieveActionableRealms("delete any "+u);m=m.concat(h);var g=n.retrieveActionableRealms("delete own "+u);p=p.concat(g)}return!!c.a.intersection(m,f).length||!(!d||!c.a.intersection(p,f).length)},n.retrieveSelectableRealms=function(t,n,r,a){return new Promise(function(t,n){e.api.get("/realm/selectable").then(function(e){return t(e.data)},n)})},n},S=function(e){switch(e||(e={}),e.apiURL&&e.apiURL.length||(e.apiURL="production"),e.apiURL){case"production":e.apiURL="https://api.fluro.io";break;case"staging":e.apiURL="https://api.staging.fluro.io";break;case"local":e.apiURL="http://api.fluro.localhost:3000"}var t={apiURL:e.apiURL,applicationToken:e.applicationToken,domain:e.domain||""},n=v;Object.defineProperty(t,"cache",{value:n,writable:!1});var r=f;Object.defineProperty(t,"utils",{value:r,writable:!1});var a=y;Object.defineProperty(t,"date",{value:a,writable:!1});var i=new s(t);Object.defineProperty(t,"api",{value:i,writable:!1});var o=new R(t);Object.defineProperty(t,"content",{value:o,writable:!1});var u=new m(t);Object.defineProperty(t,"auth",{value:u,writable:!1});var c=new P(t);Object.defineProperty(t,"access",{value:c,writable:!1});var l=new p(t);Object.defineProperty(t,"asset",{value:l,writable:!1});new D(t);Object.defineProperty(t,"stats",{value:new D(t),writable:!1});var d=new M(t);return Object.defineProperty(t,"types",{value:d,writable:!1}),t};t.default=S}});