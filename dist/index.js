!function(e){function n(n){for(var r,i,u=n[0],s=n[1],l=n[2],p=0,f=[];p<u.length;p++)i=u[p],a[i]&&f.push(a[i][0]),a[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);for(c&&c(n);f.length;)f.shift()();return o.push.apply(o,l||[]),t()}function t(){for(var e,n=0;n<o.length;n++){for(var t=o[n],r=!0,u=1;u<t.length;u++){var s=t[u];0!==a[s]&&(r=!1)}r&&(o.splice(n--,1),e=i(i.s=t[0]))}return e}var r={},a={0:0},o=[];function i(n){if(r[n])return r[n].exports;var t=r[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=e,i.c=r,i.d=function(e,n,t){i.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,n){if(1&n&&(e=i(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(i.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)i.d(t,r,function(n){return e[n]}.bind(null,r));return t},i.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(n,"a",n),n},i.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},i.p="";var u=window.webpackJsonp=window.webpackJsonp||[],s=u.push.bind(u);u.push=n,u=u.slice();for(var l=0;l<u.length;l++)n(u[l]);var c=s;o.push([40,1]),t()}({40:function(e,n,t){"use strict";t.r(n);var r=t(3),a=t.n(r),o=t(42),i=t(43),u=function(e){var n=a.a.create({adapter:Object(o.a)(Object(i.a)(a.a.defaults.adapter))});return n.defaults.baseURL=e.apiURL,n.defaults.headers.common.Accept="application/json",n},s=function(e){if(!e.api)throw new Error("Can't Instantiate FluroAuth before FluroAPI exists");var n,t={},r={set:function(e){t.user=e,r.onChange&&r.onChange(t.user)},logout:function(){delete t.user,r.onChange&&r.onChange(t.user)},login:function(n,a){return a||(a={}),new Promise(function(o,i){if(!n)return i({message:"Missing credentials!"});if(!n.username||!n.username.length)return i({message:"Username was not provided"});if(!n.password||!n.password.length)return i({message:"Password was not provided"});var u=e.apiURL+"/token/login";a.application&&(u="/fluro/application/login"),a.managedAccount&&(u=e.apiURL+"/managed/"+a.managedAccount+"/login"),a.url&&(u=a.url),e.api.post(u,n,{bypassInterceptor:!0}).then(function(e){t.user=e.data,r.onChange&&r.onChange(t.user)},i)})}};return r.logout=function(){delete t.user,r.onChange&&r.onChange(t.user)},r.refreshAccessToken=function(a){return n||(n=new Promise(function(o,i){e.api.post("token/refresh",{refreshToken:a},{bypassInterceptor:!0}).then(function(e){t.user=e.data,r.onChange&&r.onChange(t.user),o(e.data.token),n=null},i)}))},r.getCurrentToken=function(){return _.get(t,"user.token")||e.applicationToken},e.api.interceptors.request.use(function(n){if(n.bypassInterceptor)return n;var a=n,o=_.get(t,"user.token"),i=_.get(t,"refresh.token");if(!o)return e.applicationToken&&e.applicationToken.length?(a.headers.Authorization="Bearer "+e.applicationToken,a):a;if(a.headers.Authorization="Bearer "+o,!i)return a;var u=new Date,s=_.get(t,"user.expires");return u<new Date(s)?a:(console.log("Token expired"),new Promise(function(e,n){r.refreshAccessToken(i).then(function(n){return console.log("Token refreshed"),a.headers.Authorization="Bearer "+n,e(a)},n)}))},function(e){return Promise.reject(e)}),e.api.interceptors.response.use(function(e){return e},function(n){switch(n.response.status){case 401:r.logout();break;case 502:case 504:return console.log("Retry request"),e.api.request(n.config)}return Promise.reject(n)}),r},l=function(e){window||(window={screen:{width:1920,height:1080}});var n=window.devicePixelRatio>1,t={};function r(n,t){if(t.extension&&t.extension.length?(t.title&&t.title.length?(t.title,t.extension,delete t.title):t.filename&&t.filename.length?(t.filename,t.extension,delete t.filename):t.extension,delete t.extension):t.filename&&t.filename.length&&(t.filename,delete t.filename),!t.withoutToken){var r=e.auth.getCurrentToken();!t.access_token&&r&&(t.access_token=r)}}return t.getUrl=function(n,t){if(n&&String(n).length){t||(t={});var a=`${e.apiURL}/get/${n}`;r(0,t);var o=e.utils.mapParameters(t);return o.length&&(a+="?"+o),a}},t.avatarUrl=function(n,t,a){if(n&&String(n).length){a||(a={}),t||(t="contact");var o=`${e.apiURL}/get/avatar/${t}/${n}`;r(0,a);var i=e.utils.mapParameters(a);return i.length&&(o+="?"+i),o}},t.coverImage=function(n,t,a){if(n&&String(n).length){a||(a={}),t||(t="event");var o=`${e.apiURL}/get/${t}/${n}`;r(0,a);var i=e.utils.mapParameters(a);return i.length&&(o+="?"+i),o}},t.downloadUrl=function(n,t){if(n&&String(n).length){t||(t={});var a=`${e.apiURL}/download/${n}`;r(0,t);var o=e.utils.mapParameters(t);return o.length&&(a+="?"+o),a}},t.posterUrl=function(t,a,o,i){if(t&&String(t).length){i||(i={});var u,s=window.screen.width||1920;window.screen.width,u=n?1920:1200,s<=768&&(u=n?1536:768),s<=320&&(u=n?640:320),a||o?(a&&(i.w=a,o||(i.h=Math.round(a*(9/16)))),o&&(i.h=o)):(i.w=u,i.h=Math.round(u*(9/16)));var l=`${e.apiURL}/get/${t}/poster`;r(0,i);var c=e.utils.mapParameters(i);return c.length&&(l+="?"+c),l}},t.imageUrl=function(t,a,o,i){if(t&&String(t).length){i||(i={});var u,s=e.apiURL+"/get/"+t;u=n?1920:1200,$window.screen.width<=768&&(u=n?1536:768),$window.screen.width<=320&&(u=n?640:320),a||o?(a&&(i.w=a),o&&(i.h=o)):i.w=u,i.quality||(i.quality=90),r(0,i);var l=e.utils.mapParameters(i);return l.length&&(s+="?"+l),s}},t},c=t(8),p=t.n(c),f={mapParameters:function(e){return p.a.map(e,function(e,n){return encodeURIComponent(n)+"="+encodeURIComponent(e)}).join("&")},arrayIDs:function(e,n){return e?p.a.chain(e).compact().map(function(e){return f.getStringID(e,n)}).compact().uniq().value():e},getStringID:function(e,n){return e?e._id?String(e._id):String(e):e}},g=f,h=function(e){switch(e||(e={}),e.apiURL&&e.apiURL.length||(e.apiURL="production"),e.apiURL){case"production":e.apiURL="https://api.fluro.io";break;case"staging":e.apiURL="https://api.staging.fluro.io";break;case"local":e.apiURL="http://api.fluro.localhost:3000"}var n={apiURL:e.apiURL};return Object.defineProperty(n,"api",{value:new u(n),writable:!1}),Object.defineProperty(n,"auth",{value:new s(n),writable:!1}),Object.defineProperty(n,"asset",{value:new l(n),writable:!1}),Object.defineProperty(n,"utils",{value:g,writable:!1}),n};n.default=h}});